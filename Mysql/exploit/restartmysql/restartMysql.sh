#!/bin/ksh
#==============================================================================
#
# NOM
#      restartMysql.sh
#
# ********************************************************
# AUTEUR           : MEMODBA
# VERSION          : 1.00.00 
# DATE DE CREATION : 20141126
# ********************************************************
# DESCRIPTION
#      Script pour les versions Mysql
#      Redémarrage de Mysql   
#
# USAGE
#      restartMysql.ksh
#      en general a lancer deux fois par semaine
#      exemple de lancement par crontab 
#      5 * * * 6 /app/script/restartmysql/restartMysql.ksh >/app/script/restartMysql/log/restartMysql.log 2>&1
# Emplacement
#		/app/script/restartmysql
#
# ********************************************************
# *                   MODIFICATIONS                      *
# *------------------------------------------------------*
# * Quand    | Qui     | Quoi                                *
# *------------------------------------------------------*
#  20141126   MEMODBA    Creation
# ********************************************************
#==============================================================================

LOG=/opt/mysql/restartMysql.log

#************************* F_Aff_Usage() *******************************
F_Aff_Usage(){
   echo "Usage :"

   echo "        $0 Type de temp: tmpdir|tmpfs"
   echo ""
}



if [ "$#" = "0" ]
then
  F_Aff_Usage  
  exit 1
fi

TMPTYPE=$1


echo "------------------------------------" >> $LOG
echo $(date +"%d/%m/%Y:%H:%M:%S"): Redémarrage de mysql en $TMPTYPE  >> $LOG

cp -f /etc/my.cnf.$TMPTYPE /etc/my.cnf

/etc/init.d/mysqld restart >> $LOG

echo $(date +"%d/%m/%Y:%H:%M:%S"):Fin du redémarrage de mysql en $TMPTYPE  >> $LOG